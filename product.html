<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory Viewer</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #121212;
      color: #f0f0f0;
      transition: background-color 0.3s, color 0.3s;
    }
    .light-theme {
      background-color: #f8f9fa !important;
      color: #212529 !important;
    }
    h2 {
      font-weight: 700;
    }
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
    }
    table {
      background-color: inherit;
    }
  </style>
</head>

<body>

<div class="theme-toggle">
  <button id="toggleTheme" class="btn btn-secondary">Toggle Theme</button>
</div>

<div class="container mt-5">
  <h2 class="text-center mb-4">ðŸ“¦ Inventory Viewer</h2>

  <!-- Category Dropdown -->
  <div class="mb-4">
    <select id="categoryFilter" class="form-select">
      <option value="">Select Category</option>
    </select>
  </div>

  <!-- Products Table Display -->
  <div id="products-container" class="table-responsive">
    <!-- Product table will appear here -->
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
const apiUrl = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLi26KShIGLUtcpC4RP7Q5fUAiElHLKws2m6CYJpuq-gEmt8dxKufezQaHGSrTIhVohYYPkAkAdn8H8Rs34O3dLMBgQYpBrJpRTP2zs0SRZeSnKJvJXn5DasYwrUR2MBuCUsKXsgbxIu4sFCADNPjhNoWqV12C_xFJZAreR2T3MFawR_J5rLBAq98MOug9czKymjjseM_gkP0qAzyCEXHH2gHeLTSzM2LsfYU0ofxVXMdKA3vUeJ55EWd4Eshavzp5RlzyJcNWNMIreaZiBJbGA4t_1MJg&lib=MN33FsH7zRsgg_8bVV0RXOohszw5CC5XT";

let inventoryData = [];

// Fetch data on load
fetch(apiUrl)
  .then(response => response.json())
  .then(data => {
    inventoryData = data;
    populateCategoryFilter(data);
  })
  .catch(err => console.error("Error fetching inventory data:", err));

// Populate category filter dropdown
function populateCategoryFilter(data) {
  const filter = document.getElementById("categoryFilter");
  filter.innerHTML = "<option value=''>Select Category</option>";

  const categories = [...new Set(data.map(item => item.category))];
  categories.sort();

  categories.forEach(category => {
    const option = document.createElement("option");
    option.value = category;
    option.text = category;
    filter.appendChild(option);
  });
}

// Category filter functionality
document.getElementById("categoryFilter").addEventListener("change", function() {
  const selectedCategory = this.value;
  showProductsByCategory(selectedCategory);
});

// Show products in selected category in table format
function showProductsByCategory(category) {
  const container = document.getElementById("products-container");

  const filteredData = inventoryData.filter(item => item.category === category);
  container.innerHTML = "";

  if (filteredData.length === 0) {
    container.innerHTML = "<p>No products found.</p>";
    return;
  }

  let table = `
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th>Product</th>
          <th>Category</th>
          <th>Single Cost</th>
          <th>Full Box Cost</th>
          <th>Five Box Cost</th>
          <th>Status</th>
          <th>Contact</th>
        </tr>
      </thead>
      <tbody>
  `;

  filteredData.forEach(item => {
    table += `
      <tr>
        <td>${item.product}</td>
        <td>${item.category}</td>
        <td>â‚¹${item.single_cost}</td>
        <td>â‚¹${item.full_box_cost}</td>
        <td>â‚¹${item.five_box_cost}</td>
        <td>${item.status}</td>
        <td>${item.contact}</td>
      </tr>
    `;
  });

  table += `
      </tbody>
    </table>
  `;

  container.innerHTML = table;
}

// Toggle theme functionality
document.getElementById("toggleTheme").addEventListener("click", function() {
  document.body.classList.toggle("light-theme");
});
</script>

</body>
</html>
